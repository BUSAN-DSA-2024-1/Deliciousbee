<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<div class="ranking">
		<h2>ë¦¬ë·°ì™•ğŸ‘‘</h2>
		<table class="table table-striped">
			<thead>
				<tr>
					<th>#</th>
					<th style="text-align: left;">ë‹‰ë„¤ì„</th>
					<th style="text-align: light; white-space: nowrap;">ë¦¬ë·° ìˆ˜</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="myPage, status : ${reviewCount}"
					th:if="${status.index} < 4">
					<td class="center" th:if="${status.index} == 0">ğŸ¥‡</td>
					<td class="center" th:if="${status.index} == 1">ğŸ¥ˆ</td>
					<td class="center" th:if="${status.index} == 2">ğŸ¥‰</td>
					<td class="center" th:unless="${status.index} < 3"
						th:text="${status.index + 1} + ." style="padding-left: 8px;"></td>
					<td class="center"><a
						th:href="@{/member/myPage(id=${myPage.id})}" class="nickname-link">
							<span th:text="${myPage.beeMember.nickname}"></span>
					</a> ë‹˜</td>
					<td class="center" style="text-align: center;"
						th:text="${myPage.beeMember.review.size()}"></td>
				</tr>
			</tbody>
		</table>


		<div class="random-review" id="randomReviewSlider">
			<h3>ì˜¤ëŠ˜ì˜ ë ˆìŠ¤í† ë‘</h3>
			<div id="randomRestaurantContainer" class="restaurant-random-container">
					 <div id="currentRandomRestaurant">  <!-- id ë³€ê²½: currentRandomRestaurant -->
            <!-- ëœë¤ ë ˆìŠ¤í† ë‘ ë¦¬ë·°ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤. -->
       		 </div>
					 <button id="nextRestaurantButton">ë‹¤ìŒ</button>  
				</div>
		</div>
	</div>
</body>

//ëœë¤ ë ˆìŠ¤í† ë‘
 $(document).ready(function() {
     let currentRestaurantIndex = 0;
     let randomRestaurants = [];
     let intervalId; // ìë™ ìŠ¬ë¼ì´ë“œë¥¼ ìœ„í•œ interval ID ì €ì¥

     function loadRandomRestaurants() {
         $.ajax({
             url: '/member/randomRestaurants', // ëœë¤ ë ˆìŠ¤í† ë‘ URLë¡œ ë³€ê²½
             type: 'GET',
             success: function(data) {
                 randomRestaurants = JSON.parse(data);
                 if (randomRestaurants.length > 0) { // ë ˆìŠ¤í† ë‘ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ìŠ¬ë¼ì´ë“œ ì‹œì‘
                     showRandomRestaurant(currentRestaurantIndex);
                     startAutoSlide();
                 }
             },
             error: function(error) {
                 console.error('ëœë¤ ë ˆìŠ¤í† ë‘ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
             }
         });
     }

     loadRandomRestaurants(); // í˜ì´ì§€ ë¡œë“œ ì‹œ ë ˆìŠ¤í† ë‘ ë¡œë“œ

     function showRandomRestaurant(index) {
         if (randomRestaurants.length === 0) {
             $('#currentRtReview').html("<p>ì˜¤ëŠ˜ì˜ ë ˆìŠ¤í† ë‘ì´ ì—†ìŠµë‹ˆë‹¤.</p>"); // ë ˆìŠ¤í† ë‘ ì—†ì„ ë•Œ ë©”ì‹œì§€ í‘œì‹œ
             return;
         }

         const restaurant = randomRestaurants[index];
         let restaurantHtml = `
             <a href="/restaurant/rtread/${restaurant.restaurantId}?reviewId=${restaurant.restaurantId}" class="random-restaurant-link">
                 <div class="random-restaurant-image">
                     <img src="${restaurant.imageUrl}" alt="Random Restaurant Image">
                 </div>
                 <div class="random-restaurant-content">
                     <span>${restaurant.restaurantName}</span>
                 </div>
             </a>
         `;

         // ë¶€ë“œëŸ½ê³  ì²œì²œíˆ ìŠ¬ë¼ì´ë“œ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ ì ìš©
         $('#currentRtReview').slideUp(800, function() {
             $(this).html(restaurantHtml).slideDown(800); // ì²œì²œíˆ ë¶€ë“œëŸ½ê²Œ ë‚´ë ¤ì˜¤ë„ë¡ ì„¤ì •
         });
     }

     $("#nextRtButton").click(function() {
         clearInterval(intervalId); // ìˆ˜ë™ í´ë¦­ ì‹œ ìë™ ìŠ¬ë¼ì´ë“œ ë©ˆì¶¤
         currentRestaurantIndex = (currentRestaurantIndex + 1) % randomRestaurants.length;
         showRandomRestaurant(currentRestaurantIndex);
         startAutoSlide(); // ë‹¤ì‹œ ìë™ ìŠ¬ë¼ì´ë“œ ì‹œì‘
     });

     function startAutoSlide() {
         intervalId = setInterval(function() {
             currentRestaurantIndex = (currentRestaurantIndex + 1) % randomRestaurants.length;
             showRandomRestaurant(currentRestaurantIndex);
         }, 7000); // 7ì´ˆë§ˆë‹¤ ìŠ¬ë¼ì´ë“œ
     }
 });
 
</html>